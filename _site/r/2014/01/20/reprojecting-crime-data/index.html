<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

  <title>
    Reprojecting Crime data from Police.uk from Latitude & Longitude (WGS84) to Eastings & Northings (British National Grid) &middot; 
    Geographic Data Science Laboratory
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-gdsl">

    <header class="masthead">
      <div class="masthead-inner">
			 <div class="img-circular"></div>
        <h1>Geographic Data Science Laboratory</h1>
        <p class="lead">Geographic Data Science Laboratory at the University of Liverpool</p>

        <div class="colophon">
          <ul class="colophon-links">
             <li>
              <a href="/about">About</a>
            </li>
             <li>
              <a href="/">Blog</a>
            </li>
              <li>
              <a href="http://atlas.geographicdatascience.org">Atlas</a>
            </li>
           <li>
              <a href="/people/">People</a>
            </li>
             <li>
              <a href="/projects/">Our Projects</a>
            </li>
            <li>
              <a href="/join/">Join Us</a>
            </li>
             <li>
              <a href="/contact/">Contact Us</a>
            </li>
          </ul>
          <p>&copy; 2014. Geographic Data Science Laboratory All rights reserved.</p>
          <a href="/atom.xml"><img class="img-feed" src="/public/images/iconmonstr-rss-3-icon.svg"></a></img><a href="https://twitter.com/geodatascience"><img class="img-feed" src="/public/images/iconmonstr-twitter-3-icon.svg"></img></a><a href="https://github.com/alexsingleton/geographicdatascience"><img class="img-feed" src="/public/images/iconmonstr-github-8-icon.svg"></a></br>
         <a href="http://www.liv.ac.uk"><img class="img-uni" src="/public/images/whiteout_logo_616.png"></a> 
        </div>
      </div>
    </header>

    <div class="content container">
      <div class="post">
  <h1>Reprojecting Crime data from Police.uk from Latitude & Longitude (WGS84) to Eastings & Northings (British National Grid)</h1>
      <span class="post-date">
    	<img class="img-icon" src="/public/images/iconmonstr-calendar-5-icon.svg"></img>20 Jan 2014
   		<img class="img-icon" src="/public/images/iconmonstr-user-icon.svg"></img>Nick Bearman
   		<img class="img-icon" src="/public/images/iconmonstr-tags-3-icon.svg"></img> r  
    	<img class="img-icon" src="/public/images/iconmonstr-speech-bubble-14-icon.svg"></img><a href="http://www.geographicdatascience.com/r/2014/01/20/reprojecting-crime-data/#disqus_thread" data-disqus-identifier="/r/2014/01/20/reprojecting-crime-data/"></a>
	    <img class="img-icon" src="/public/images/iconmonstr-twitter-icon.svg"><a href="https://twitter.com/share?url=http://www.geographicdatascience.com/r/2014/01/20/reprojecting-crime-data/&text=Reprojecting Crime data from Police.uk from Latitude & Longitude (WGS84) to Eastings & Northings (British National Grid)" target="_blank">Tweet this!</a>
	  </span>
  <p>I have recently taken over a second year undergraduate module, 'Applied GIS and Modelling'. The first practical element of the course (spread over 8 hours of lab sessions over the first 2 weeks) introduces the students to GIS and using R to show, create and handle spatial data. One of the exercises uses crime data downloaded from the Police.uk website.</p>

<p>While going through the material, I discovered that the crime data available through the Police.uk website had changed format. <!-- more --> The data file used last year previously contained coordinates in Eastings and Northings (the <a href="http://www.ordnancesurvey.co.uk/resources/maps-and-geographic-resources/the-national-grid.html">British National Grid</a> projection system) now had coordinates specified in Latitude and Longitude (<a href="http://spatialreference.org/ref/epsg/4326/">WGS84</a>). The students go on to plot the crime data over some LSOA boundaries (which come projected in BNG) so it would be useful to have the crime data in the same projection. This is in the first practical, so while the students do need to learn about projections at some point, I would prefer not to have to throw them in at the deep end to begin with!</p>

<p>However, the data had changed, so I needed to find a simple way of reprojecting them. Fortunately with a few tweaks to the R code, I managed to incorporate this into the practical in a way that wasn't too complex. The full practical is available at <a href="http://rpubs.com/nickbearman/gettingstartedwithr">http://rpubs.com/nickbearman/gettingstartedwithr</a>, and the bit relevant to this post begins about half-way down, at 'Working with Open Government Data'. The steps to download the crime data from Police.uk are straight forward, and are covered in the practical. The students use data from Merseyside Police, as this is their local police area. This is all done using the MapTools library in R.</p>

<pre><code class="r">    #Load the library
        require(maptools) 
    #Read in the data
        crimes &lt;- read.csv("2013-11-merseyside-street.csv") 
</code></pre>

<p>The next step reads the CSV data (with latitude and longitude fields) into a SpatialPointsDataFrame:</p>

<pre><code class="r">    #Show the head of the data
        head(crimes)
    #Create the coordinates
        coords &lt;- cbind(Longitude = as.numeric(as.character(crimes$Longitude)), Latitude = as.numeric(as.character(crimes$Latitude))) 
    #Create SpatialPointsDataFrame, specifing coordinates, data and projection
        crime.pts &lt;- SpatialPointsDataFrame(coords, crimes[, -(5:6)], proj4string = CRS("+init=epsg:4326"))
</code></pre>

<p>From the practical:</p>

<blockquote><p>"This creates a SpatialPointsDataFrame object. This first line prepares the coordinates into a form that the SpatialPointsDataFrame can use. The SpatialPointsDataFrame function on the second line takes three arguments - the first is coordinates, created in the line above. The second argument is the data frame minus columns 5 and 6 - this is what <code>-(5:6)</code> indicates. The third argument is the projection. These columns provide all the non-geographical data from the data frame. The resulting object crime.pts is a spatial points geographical shape object, whose points are each recorded crime in the data set you download."</p></blockquote>

<p>Creating a SpatialPointsDataFrame from the CSV is straight forward, but remember to specify the projection - <code>proj4string = CRS("+init=epsg:4326")</code> in our case (WGS84). The <code>[,-(5:6)]</code> means that the data element of the SpatialPointsDataFrame contains everything in crimes (the CSV file read in) apart from columns 5 &amp; 6. This is a new way of doing it to me, but quite effective!</p>

<p>Once the data is stored as a SpatialPointsDataFrame, the actual reprojection is easy - you essentially just say 'reproject this data frame to this projection', with <code>+init=epsg:27700</code> being BNG:</p>

<pre><code class="r">    #Reproject data to BNG (27700)  
        crime.pts &lt;- spTransform(crime.pts, CRS("+init=epsg:27700"))
</code></pre>

<p>As with many things in R, if it's setup correctly, then a reprojection is quite easy to do (just one line in this example!). However, it is setting up the data correctly which takes time. Previously both the shape file of the LSOAs and the crime data were read in without any projection - fine if they are both the same, but to reproject it, both need their projections specifying.</p>

<p>Hopefully this R code will be useful to you - feel free to use it in any of your work.</p>

  Posted by Nick Bearman<div class="avatar-frame"><img src="/public/images/nickbearman.jpg"></img></div>
</div>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'alexandersingleton'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/talk/2014/05/11/AAG-Geodemographic-Update/">
            Updating OAC - Assessing Classification Uncertainty and Cluster Stability During Intercensal Periods
            <small>11 May 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/talk/2014/05/11/AAG-Built-Environment/">
            Establishing Dynamic Measures of Built Environment Characteristics and their Relationship to Patterns of Socio-Spatial Structure
            <small>11 May 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/talk/2014/05/10/AAG/">
            Geographic Data Science at the AAG
            <small>10 May 2014</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      <HR>
    </div>


<!-- Comment Counts -->
<script type="text/javascript">
		var disqus_shortname = 'alexandersingleton'; // required: replace example with your forum shortname
                var disqus_identifier = '/r/2014/01/20/reprojecting-crime-data/';
		var disqus_url = 'http://www.geographicdatascience.com/r/2014/01/20/reprojecting-crime-data/';
 
		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var s = document.createElement('script'); s.async = true;
			s.type = 'text/javascript';
			s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
			(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
		}());
	</script>

  </body>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50923993-1', 'geographicdatascience.com');
  ga('send', 'pageview');

</script>

</html>
